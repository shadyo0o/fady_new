# Independent Vaccine Recording - Interaction Flow

## 1. Visual Card Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ø­Ø²Ù…Ø© Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©                           â”‚
â”‚  3 ØªØ·Ø¹ÙŠÙ…Ø§Øª Ù…Ø¹Ø§Ù‹                        ğŸ“¦       â”‚
â”‚  Ù„Ù„Ø·ÙÙ„: Ù…Ø­Ù…Ø¯                                    â”‚
â”‚  ğŸ“ Ù…ÙƒØªØ¨ Ø§Ù„ØµØ­Ø© Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù…Ø­Ø¯Ø¯                                  â”‚
â”‚  â† Ø§Ù„Ø®Ù…ÙŠØ³ (2024-02-15) â†’ 15 ÙØ¨Ø±Ø§ÙŠØ±              â”‚
â”‚  5 Ø£ÙŠØ§Ù… Ù…ØªØ¨Ù‚ÙŠØ©                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¡ ÙŠØ±Ø¬Ù‰ Ø´Ø±Ø¨ Ø§Ù„Ù…Ø§Ø¡ Ø¨ÙƒØ«Ø±Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªØ·Ø¹ÙŠÙ…            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ·Ø¹ÙŠÙ…Ø§Øª:                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â˜ Ø§Ù„Ø­Ù‚Ù†Ø© Ø§Ù„Ø«Ù„Ø§Ø«ÙŠØ©     [â± ØªÙ…]          â”‚  â”‚
â”‚  â”‚   Click for form      Submit â†’ API       â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ â˜ Ø§Ù„Ø´Ù„Ù„               [â± ØªÙ…]          â”‚  â”‚
â”‚  â”‚   Click for form      Submit â†’ API       â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ âŒ Ø§Ù„Ø¯Ø±Ù† (ØºÙŠØ± Ù…ØªÙˆÙØ±)  [âŒ ØºÙŠØ± Ù…ØªØ§Ø­]    â”‚  â”‚
â”‚  â”‚    ØªØ­Ø°ÙŠØ±: ØºÙŠØ± Ù…ØªÙˆÙØ±      Disabled       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LEGEND:
â˜ = Available for recording
âŒ = Unavailable (disabled)
âœ“ = Already recorded (green, disabled)
```

---

## 2. State Machine

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      VACCINE ROW STATE                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    INITIAL STATE
                         â”‚
                         â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚      IS VACCINE AVAILABLE?        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”œâ”€â”€â”€ NO â”€â”€â”€â”€â”€â”¬â”€â”€â”€ YES â”€â”€â”€â”
              â”‚            â”‚           â”‚
              â–¼            â–¼           â–¼
      [UNAVAILABLE]  [AVAILABLE]  [RECORDED]
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ Red button   â€¢ Blue/White â€¢ Green btn
      â€¢ âŒ Icon      â€¢ â± Icon     â€¢ âœ“ Icon
      â€¢ Disabled     â€¢ Click opens â€¢ Disabled
      â€¢ Warning txt    modal

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  USER CLICKS TEM  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                     â”‚
              â–¼                     â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  MODAL OPENS     â”‚  â”‚ ALREADY RECORDED â”‚
      â”‚  Form fills in   â”‚  â”‚ Show toast info  â”‚
      â”‚  For THIS vaccineâ”‚  â”‚ Return to card   â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ USER SUBMITS     â”‚
      â”‚ API CALL:        â”‚
      â”‚ POST /recordVax  â”‚
      â”‚ scheduleId: X    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
      â”‚               â”‚
      â–¼               â–¼
   SUCCESS         ERROR
   â”€â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€
   â€¢ Set state     â€¢ Toast
   â€¢ Show toast    â€¢ Keep btn
   â€¢ Disable btn     available
   â€¢ Mark recorded
```

---

## 3. Component Interaction Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       DASHBOARD                              â”‚
â”‚  (Fetches vaccine data and groups by date)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚
                         â”‚ Passes visitPackage
                         â”‚ with allVaccines[]
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  SmartVisitPackageCard Component       â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ State:                                 â”‚
        â”‚  â€¢ recordedVaccines = {}               â”‚
        â”‚  â€¢ showRecordModal = false             â”‚
        â”‚  â€¢ selectedVaccineForRecord = null     â”‚
        â”‚                                        â”‚
        â”‚ Renders: {allVaccines.map(...)}        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚              â”‚              â”‚
          â–¼              â–¼              â–¼
     [Vaccine 1]  [Vaccine 2]  [Vaccine 3]
      Ghada        Shallal      BCG
      Available    Available    Unavailable
     
     Each renders:
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ [Vaccine Title] [ØªÙ… Button]     â”‚
     â”‚ onClick: handleOpenRecordModal() â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ RecordVaccineModal Component    â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚ Props:                          â”‚
     â”‚  â€¢ isOpen: boolean              â”‚
     â”‚  â€¢ childId: string              â”‚
     â”‚  â€¢ scheduleId: string â­        â”‚
     â”‚  â€¢ vaccineName: string          â”‚
     â”‚  â€¢ onSuccess: callback          â”‚
     â”‚                                 â”‚
     â”‚ Inside Modal:                   â”‚
     â”‚  1. Date input (auto-filled)    â”‚
     â”‚  2. Office dropdown             â”‚
     â”‚  3. "ØªØ£ÙƒÙŠØ¯" button              â”‚
     â”‚       â”‚                         â”‚
     â”‚       â–¼                         â”‚
     â”‚ handleSubmit():                 â”‚
     â”‚  â€¢ Validate childId             â”‚
     â”‚  â€¢ Validate scheduleId          â”‚
     â”‚  â€¢ Call API with ONLY this      â”‚
     â”‚    vaccine's scheduleId         â”‚
     â”‚                                 â”‚
     â”‚  On Success:                    â”‚
     â”‚  â€¢ Call onSuccess()             â”‚
     â”‚  â€¢ Close modal                  â”‚
     â”‚                                 â”‚
     â”‚  On Error:                      â”‚
     â”‚  â€¢ Show error toast             â”‚
     â”‚  â€¢ Keep modal open              â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ onSuccess()
              â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ handleRecordSuccess()           â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚ â€¢ Update recordedVaccines state â”‚
     â”‚   recordedVaccines[scheduleId]  â”‚
     â”‚      = true                     â”‚
     â”‚                                 â”‚
     â”‚ â€¢ Show success toast            â”‚
     â”‚ â€¢ Close modal                   â”‚
     â”‚ â€¢ Clear selected vaccine        â”‚
     â”‚                                 â”‚
     â”‚ Component RERENDERS with:       â”‚
     â”‚ â€¢ That vaccine button GREEN     â”‚
     â”‚ â€¢ Button now DISABLED           â”‚
     â”‚ â€¢ Shows "âœ“ ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„"        â”‚
     â”‚ â€¢ OTHER vaccines still BLUE     â”‚
     â”‚ â€¢ Can click next vaccine        â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. API Call Sequence

```
Timeline of API Calls for Recording 3 Vaccines on Same Date:

TIME    COMPONENT              ACTION                    PAYLOAD
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

T0      Dashboard            fetches nextVaccines[]
        â†“
        [API] GET /getNextVaccine
        â† Returns: [{scheduleId: 1, title: Ghada}, ...]

T1      SmartVisitPackageCard renders
        allVaccines = [
          {scheduleId: 1, title: "Ghada", available: true},
          {scheduleId: 2, title: "Shallal", available: true},
          {scheduleId: 3, title: "BCG", available: false}
        ]

T2      User clicks "ØªÙ…" for Vaccine 1
        handleOpenRecordModal({scheduleId: 1, title: "Ghada"})
        â†“
        showRecordModal = true
        selectedVaccineForRecord = vaccine1

T3      RecordVaccineModal opens
        Form shows: "ØªØ³Ø¬ÙŠÙ„ ØªØ·Ø¹ÙŠÙ…: Ghada"

T4      User clicks "ØªØ£ÙƒÙŠØ¯"
        handleSubmit() called
        â†“
        [API] POST /childs/recordVaccine
        {
          childId: "child123",
          scheduleId: 1,              â­ ONLY vaccine #1
          actualDate: "2024-02-15",
          office: "Ù…ÙƒØªØ¨ Ø§Ù„ØµØ­Ø©"
        }

T5      API Response
        â† {success: true, message: "..."}
        â†“
        onSuccess() callback
        â†“
        handleRecordSuccess()
        recordedVaccines[1] = true
        showToast.success("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ù‚Ù†Ø© Ø§Ù„Ø«Ù„Ø§Ø«ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­ âœ…")
        Modal closes
        â†“
        Component rerenders:
        â€¢ Vaccine 1 button: GREEN âœ“ ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (disabled)
        â€¢ Vaccine 2 button: BLUE â± ØªÙ… (clickable)
        â€¢ Vaccine 3 button: RED âŒ ØºÙŠØ± Ù…ØªØ§Ø­ (disabled)

T6      User clicks "ØªÙ…" for Vaccine 2
        (SAME PROCESS)
        â†“
        [API] POST /childs/recordVaccine
        {
          childId: "child123",
          scheduleId: 2,              â­ DIFFERENT ID
          actualDate: "2024-02-15",
          office: "Ù…ÙƒØªØ¨ Ø§Ù„ØµØ­Ø©"
        }

T7      API Response
        â† Success
        recordedVaccines[2] = true
        â†“
        Component rerenders:
        â€¢ Vaccine 1 button: GREEN âœ“ ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (disabled)
        â€¢ Vaccine 2 button: GREEN âœ“ ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (disabled)  â­ NOW GREEN
        â€¢ Vaccine 3 button: RED âŒ ØºÙŠØ± Ù…ØªØ§Ø­ (disabled)

T8      User tries to click Vaccine 3
        handleOpenRecordModal({scheduleId: 3, isAvailable: false})
        â†“
        if (vaccine.isAvailable === false) {
          showToast.warning("BCG ØºÙŠØ± Ù…ØªÙˆÙØ± ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ")
          return;  // Don't open modal
        }

T9      Dashboard shows FINAL STATE:
        âœ“ Vaccine 1 - RECORDED
        âœ“ Vaccine 2 - RECORDED
        âŒ Vaccine 3 - UNAVAILABLE
```

---

## 5. Data Flow: Single Vaccine Recording

```
Input Data (from API):
{
  scheduleId: "ghada-001",
  title: "Ø§Ù„Ø­Ù‚Ù†Ø© Ø§Ù„Ø«Ù„Ø§Ø«ÙŠØ©",
  date: "2024-02-15",
  isAvailable: true,
  warning: null
}

        â†“ User clicks button
        
SmartVisitPackageCard State Update:
{
  selectedVaccineForRecord: {
    scheduleId: "ghada-001",
    title: "Ø§Ù„Ø­Ù‚Ù†Ø© Ø§Ù„Ø«Ù„Ø§Ø«ÙŠØ©",
    ...
  },
  showRecordModal: true
}

        â†“ Modal Form Submission
        
API Call Payload:
{
  childId: "child123",
  scheduleId: "ghada-001",      â­ KEY FIELD
  actualDate: "2024-02-15",
  office: "Ù…ÙƒØªØ¨ Ø§Ù„ØµØ­Ø© Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ"
}

        â†“ API Response
        
Backend Response:
{
  success: true,
  vaccine: {
    scheduleId: "ghada-001",
    status: "recorded",
    recordedAt: "2024-02-15T14:30:00Z"
  }
}

        â†“ onSuccess Callback
        
Update Component State:
{
  recordedVaccines: {
    "ghada-001": true  â­ MARKS THIS VACCINE AS RECORDED
  },
  showRecordModal: false,
  selectedVaccineForRecord: null
}

        â†“ Component Rerender
        
UI Update:
Button for "ghada-001" changes:
  FROM: [â± ØªÙ…] (blue, clickable)
  TO:   [âœ“ ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„] (green, disabled)

Other vaccines:
  [â± ØªÙ…] (still blue, still clickable)
```

---

## 6. Error Handling Flow

```
User Clicks "ØªÙ…"
      â”‚
      â–¼
Modal Opens
      â”‚
      â–¼
User Fills Form & Submits
      â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                                 â”‚
      â–¼                                 â–¼
   SUCCESS                            ERROR
   
   â”œâ”€ 200 OK                          â”œâ”€ 400 Bad Request
   â”‚  â”œâ”€ Update state                 â”‚  â””â”€ Show: "Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©"
   â”‚  â”œâ”€ Success toast                â”‚
   â”‚  â”œâ”€ Close modal                  â”œâ”€ 401 Unauthorized
   â”‚  â””â”€ Rerender card                â”‚  â””â”€ Show: "ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„"
   â”‚                                  â”‚
   â”‚                                  â”œâ”€ 404 Not Found
   â”‚                                  â”‚  â””â”€ Show: "Ø§Ù„ØªØ·Ø¹ÙŠÙ… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯"
   â”‚                                  â”‚
   â”‚                                  â”œâ”€ 500 Server Error
   â”‚                                  â”‚  â””â”€ Show: "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…"
   â”‚                                  â”‚
   â”‚                                  â””â”€ Network Error
   â”‚                                     â””â”€ Show: "ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„"
   â”‚
   â–¼
User can record next vaccine immediately
```

---

## 7. Button State Transitions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BUTTON STATE MACHINE                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Initial State Tree:
â”œâ”€ isAvailable === true
â”‚  â””â”€ recordedVaccines[scheduleId] === undefined
â”‚     â””â”€ STATE: AVAILABLE âœ…
â”‚        â€¢ Button Text: "â± ØªÙ…"
â”‚        â€¢ Button Color: Blue/White
â”‚        â€¢ Disabled: false
â”‚        â€¢ onClick: Opens modal
â”‚
â”œâ”€ isAvailable === true
â”‚  â””â”€ recordedVaccines[scheduleId] === true
â”‚     â””â”€ STATE: RECORDED âœ…
â”‚        â€¢ Button Text: "âœ“ ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„"
â”‚        â€¢ Button Color: Green
â”‚        â€¢ Disabled: true
â”‚        â€¢ onClick: Toast info "Ù…Ø³Ø¨Ù‚Ø§Ù‹"
â”‚
â””â”€ isAvailable === false
   â”œâ”€ Any recorded state
   â””â”€ STATE: UNAVAILABLE âŒ
      â€¢ Button Text: "âŒ ØºÙŠØ± Ù…ØªØ§Ø­"
      â€¢ Button Color: Red
      â€¢ Disabled: true
      â€¢ onClick: Toast warning "ØºÙŠØ± Ù…ØªÙˆÙØ±"


State Transitions:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

AVAILABLE â”€â”€[User clicks]â”€â†’ MODAL OPENS
   â”‚
   â”‚                         â”‚
   â”‚         [User submits]  â”‚
   â”‚             â”‚           â”‚
   â”‚             â–¼           â”‚
   â”‚         API CALL        â”‚
   â”‚             â”‚           â”‚
   â”‚       â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”     â”‚
   â”‚       â”‚           â”‚     â”‚
   â”‚     SUCCESS     FAILURE â”‚
   â”‚       â”‚           â”‚     â”‚
   â”‚       â–¼           â–¼     â”‚
   â”‚     RECORDED    AVAILABLE â—„â”€â”€â”€â”€â”˜
   â”‚       â”‚           â”‚
   â”‚       â”‚           â””â”€ Show error toast
   â”‚       â”‚              User can retry
   â”‚       â”‚
   â”‚       â””â”€ Green button, disabled
   â”‚          "âœ“ ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„"
   â”‚
   â””â”€ User cannot click again
```

---

## 8. Complete Sequence Diagram (Mermaid-style)

```
PARTICIPANT: Mother
PARTICIPANT: SmartVisitPackageCard
PARTICIPANT: RecordVaccineModal
PARTICIPANT: API Server
PARTICIPANT: Dashboard

Mother â†’ SmartVisitPackageCard: Sees 3 vaccines grouped
SmartVisitPackageCard â†’ Mother: Shows card with 3 rows

Mother â†’ SmartVisitPackageCard: Clicks "ØªÙ…" for Vaccine 1
SmartVisitPackageCard â†’ RecordVaccineModal: Open with vaccine 1 data
RecordVaccineModal â†’ Mother: Shows form (date, office)

Mother â†’ RecordVaccineModal: Fills date, selects office, clicks ØªØ£ÙƒÙŠØ¯
RecordVaccineModal â†’ API Server: POST /recordVaccine {scheduleId: 1, ...}
API Server â†’ RecordVaccineModal: 200 OK {success: true}

RecordVaccineModal â†’ SmartVisitPackageCard: onSuccess() callback
SmartVisitPackageCard â†’ SmartVisitPackageCard: recordedVaccines[1] = true
SmartVisitPackageCard â†’ Mother: Toast "ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­"
SmartVisitPackageCard â†’ Mother: Update vaccine 1 button to GREEN âœ“

Mother â†’ SmartVisitPackageCard: Sees vaccine 1 marked, vaccine 2 still blue
Mother â†’ SmartVisitPackageCard: Clicks "ØªÙ…" for Vaccine 2
SmartVisitPackageCard â†’ RecordVaccineModal: Open with vaccine 2 data
RecordVaccineModal â†’ Mother: Shows form

Mother â†’ RecordVaccineModal: Fills and submits
RecordVaccineModal â†’ API Server: POST /recordVaccine {scheduleId: 2, ...}
API Server â†’ RecordVaccineModal: 200 OK

RecordVaccineModal â†’ SmartVisitPackageCard: onSuccess()
SmartVisitPackageCard â†’ SmartVisitPackageCard: recordedVaccines[2] = true
SmartVisitPackageCard â†’ Mother: Toast "ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­"
SmartVisitPackageCard â†’ Mother: Vaccine 2 button now GREEN âœ“

Mother â†’ SmartVisitPackageCard: Tries to click "ØªÙ…" for Vaccine 3 (unavailable)
SmartVisitPackageCard â†’ Mother: Toast "BCG ØºÙŠØ± Ù…ØªÙˆÙØ± ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ"
SmartVisitPackageCard â†’ Mother: Button remains RED âŒ, disabled

Mother â†’ Dashboard: Final state shows 2 vaccinated, 1 unavailable
```
